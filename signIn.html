<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Signed In</title>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <!-- Compiled and minified CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/css/materialize.min.css">
            
    <style>
      #element {
        display: block;
        margin: auto;
        width: 70%;
        text-align: center;
      }

      #element img {
        width: 250px;
        height: 300px;
        margin: 20px;
      }

      nav {
        background-color: #1c1d1e;
      }

      nav a {
        margin-left: 50px;
      }

      nav input {
        position: relative;
        right: 50px;
      }

      nav button {
        transform: scale(0.7);
        color: #fff;
        border: none;
        background-color: transparent;
        font-size: 20px;
        
      }

    </style>

</head>
<body>
    <header>
        <nav>
            <div class="nav-wrapper">
              <a href="#" class="brand-logo">Movie<span>Now</span></a>
              <ul id="nav-mobile" class="right">
                <input style="margin-left: -100px" type="text" placeholder="Search Movie">
                <button>Sign Out</button>
              </ul>
            </div>
          </nav>        
    </header>

    <aside>
      <div id="element"></div>
    </aside>

    

    <script src="https://www.gstatic.com/firebasejs/4.3.1/firebase.js"></script>
    <script
  src="https://code.jquery.com/jquery-3.2.1.js"
  integrity="sha256-DZAnKJ/6XZ9si04Hgrsxu/8s717jcIzLy3oi35EouyE="
  crossorigin="anonymous"></script>
  <!-- Compiled and minified JavaScript -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/js/materialize.min.js"></script>
    <script>
        $(document).ready(function() {


            // Initialize Firebase
    var config = {
        apiKey: "AIzaSyA8y94LqspHnDrSs0G0IZEltIdesRw5bE4",
        authDomain: "semistack.firebaseapp.com",
        databaseURL: "https://semistack.firebaseio.com",
        projectId: "semistack",
        storageBucket: "semistack.appspot.com",
        messagingSenderId: "653222743377"
      };
      firebase.initializeApp(config);

        var auth = firebase.auth(),
	database = firebase.database();

         // Sign the logged in user out
      $("button").on('click', function (e) {

        e.preventDefault();

        auth.signOut() // firebase method to sign otu
          .then(function () {

            location.href = 'index.html'; // redirect the user to the sign in page
            
          })
          // Dealing with errors
          .catch(function (err) {
            console.log(err);
          })

      });

      

      $("input").on("keypress", (e) => {
        
        var movieData = $("input").val().trim();
        var element = document.getElementById("element");
        var fullURL = "https://api.themoviedb.org/3/search/movie?api_key=2015bad48afec319b116488447972b4c&query=" + movieData;
        
        if (e.keyCode === 13) {
         //Create function for each request
          $.ajax({
            dataType: "json",
            url: fullURL,
            async: true,
            success: function(data) {
              console.log(data);


              var image, imageURL, dataImage;


              var dataResults = data.results;

              for (var i = 0; i < data.results.length; i++) {

                dataImage = data.results[i].poster_path;
                imageURL = "https://image.tmdb.org/t/p/w500" + dataImage;

                $("img").on("click", () => {
                  location.href = "movie.html";
                  $(this).html(`
                    <div>
                      <p>${dataResults.overview}</p>
                      </div>
                  `);
                })

               working();
               /* document.body.appendChild(image)
                image.src = imageURL;  */ 

                

              }

              function working() {
                image = new Image();
                image.src = imageURL; 
                $("#element").append(image);
              }


            }
          });
        }
      })
    })
        
    </script>
</body>
</html>